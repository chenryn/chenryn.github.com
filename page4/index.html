<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>三斗室</title>
    <meta name="author" content="陈子">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/pygments/default.css" rel="stylesheet" type="text/css">
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="/">三斗室</a>
          <ul class="nav">
      	<li><a href="/archive.html">Archive</a></li>
      	<li><a href="/categories.html">Categories</a></li>
      	<li><a href="/pages.html">Pages</a></li>
      	<li><a href="/tags.html">Tags</a></li>
            <li><link title="RSS 2.0" type="application/rss+xml" href="http://chenlinux.com/feed.xml" rel="alternate" /><a href="http://chenlinux.com/feed.xml" target="_blank">RSS订阅</a></li>
            <li><a href="/projects.html">学习记录</a></li>
          </ul>
          <ul class="nav pull-right"><li><a href="/about.html">有关我</a></li></ul>
        </div>
      </div>
    </div>
    <div class="container">
    <div class="row">
      <div class="span7">
<div class="row">
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/04/18/get-location-of-some-companys" title="获取造价百强公司的真实位置" rel="bookmark">获取造价百强公司的真实位置</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-04-18 00:00:00 +0800">18 Apr 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>很久没更新，没用技术，今天稍微geek一下下。给老婆搜索她行业百强公司的具体地点，看看如果换单位的话是否方便出行~代码如下：</p>
<div class="highlight"><pre><code class="perl"><span class="c1">#!/usr/bin/perl</span>
<span class="k">use</span> <span class="nn">Data::</span><span class="n">Dumper</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">LWP::</span><span class="n">UserAgent</span><span class="p">;</span>
<span class="k">use</span> <span class="n">URI</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Web::</span><span class="n">Scraper</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">JSON::</span><span class="n">XS</span><span class="p">;</span>
<span class="c1"># 处理中文需要指定输入输出都用utf8格式，否则会有wide character in print的warning提示 </span>
<span class="k">use</span> <span class="n">utf8</span><span class="p">;</span>
<span class="nb">binmode</span><span class="p">(</span><span class="bp">STDIN</span><span class="p">,</span> <span class="s">':encoding(utf8)'</span><span class="p">);</span>
<span class="nb">binmode</span><span class="p">(</span><span class="bp">STDOUT</span><span class="p">,</span> <span class="s">':encoding(utf8)'</span><span class="p">);</span>
<span class="nb">binmode</span><span class="p">(</span><span class="bp">STDERR</span><span class="p">,</span> <span class="s">':encoding(utf8)'</span><span class="p">);</span>
<span class="c1"># 百度地图搜索的查询结果返回的是json数据，需要转换成p...</span></code></pre></div>
</body></html>
      <a href="/2012/04/18/get-location-of-some-companys" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/04/16/configs-automatically-effective-for-elastic-monitor" title="弹性集群监控中的配置自动生效问题研究" rel="bookmark">弹性集群监控中的配置自动生效问题研究</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-04-16 00:00:00 +0800">16 Apr 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#monitor-ref" title="monitor" rel="category tag">monitor</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>最近跟<a href="http://weibo.com/fedoracore">@画圈圈的星星</a> 聊天，说到nagios在大规模集群运用中一个比较严重的瓶颈：修改配置需要重启进程。 <br>
听起来似乎不是什么问题，我个人之前对nagios的追求，也都放在怎么样提供一个及时高效的监控和数据展示上面—-这两个问题在 <code>mod_gearman</code> 和 <code>pnp4nagios</code> 的协助下已经很给力了。    </p>
<p>但是聊天中提到了一个新的场景，事实上早在两个月前，<a href="http://weibo.com/tjpm">@GNUer</a> 就提到过类似的场景，就是当 nagios 监控的是这样一个弹性集群的时候：</p>
<pre><code>集群设备数以千记，...</code></pre>
</body></html>
      <a href="/2012/04/16/configs-automatically-effective-for-elastic-monitor" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/03/18/postgreSQL-DBA-2000-note2" title="PostgreSQL中国用户会DBA2000培训计划北京第二课笔记" rel="bookmark">PostgreSQL中国用户会DBA2000培训计划北京第二课笔记</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-03-18 00:00:00 +0800">18 Mar 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#database-ref" title="database" rel="category tag">database</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<h2 id="section">运行维护</h2>
<h3 id="vacuum">vacuum命令</h3>
<p>pgsql是multi-version concurrency control的，update和delete的操作并不会真正的修改原版本的内容，而只是做一个标记，最后需要用vacuum命令回收失效版本的位置。<br>
vacuum的主要作用：
1. 恢复或重用失效的空间；
2. 更新pgsql规划器的数据统计；
3. 避免事务ID的重复。
事务ID只有32位，差不多40亿左右。建议在达到10亿左右的时候就需要vacuum一次。<br>
在version8.*之后，默认就是用auto vacuum。注意auto vacuum不是定时启动，而是触发式的。</p>
<p>vacuum命令有两种形式：
1. vacuum，正常情况，不阻...</p>
</body></html>
      <a href="/2012/03/18/postgreSQL-DBA-2000-note2" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/03/17/postgreSQL-DBA-2000-note1" title="PostgreSQL中国用户会DBA2000培训计划北京第一课笔记" rel="bookmark">PostgreSQL中国用户会DBA2000培训计划北京第一课笔记</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-03-17 00:00:00 +0800">17 Mar 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#database-ref" title="database" rel="category tag">database</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<h1 id="postgresql">PostgreSQL及中国用户会简介</h1>
<p>主讲人 李元佳 galy</p>
<h2 id="section">数据库分类</h2>
<p>商业数据库: Oracle, DB2, SQLserver, Sybase…
  开源数据库: MySQL, PostgreSQL, Firebird, SQLite, Apache Derby…</p>
<h2 id="postgresql-1">PostgreSQL沿革</h2>
<p>类BSD许可的，面向对象的，关系型数据库管理系统。</p>
<p>MIT –&gt; Ingres –&gt; Postgres –&gt; PostgreSQL ( 同源的还有SQLserver等 )</p>
<p>支持SQL2008标准的大部分功能特性，是各种RDBMS的SQL方言中最贴近标准的。</p>
<h1 id="postgresql-2">PostgreSQL简介</h1>
<p>主讲人 萧少聪 Scott.Siu</p>
<h2 id="section-1">用户与进程</h2>
<p><img src="/images/uploads/pgsql-process.png" alt="postgreSQL中用户与进程的联系"></p>
<p>注意在上图中，不管是workmem还是sharebu...</p>
</body></html>
      <a href="/2012/03/17/postgreSQL-DBA-2000-note1" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/03/10/go-deep-into-nginx-operation" title="加强了解nginx的几个问题" rel="bookmark">加强了解nginx的几个问题</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-03-10 00:00:00 +0800">10 Mar 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#nginx-ref" title="nginx" rel="category tag">nginx</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>被问到一些关于nginx或者说nginx运维相关的问题，记录下来几个值得思考的。这里面有些是自己曾经想到过但是浅浅的了解下就不放在心上的，有些是根本没想过这会成为一个”有意思”的问题的……</p>
<h2 id="nginxclientip">1、nginx日志记录得到client的IP原理。</h2>
<p>nginx记录的client的IP分两种，一种是$remote_addr，一种是$http_x_forwarded_for。其中X-Forwarded-For里存放的是proxy加入的client端IP，通过http header传递的。而$remote_addr是TCP上的结果。但是具体如何不知道。今天回来翻nginx的src，先从定义nginx变量的ngx_http_variable.c看到$remote_addr是这样来的:</p>
<div class="highlight"><pre><code class="c"><span class="n">ngx_http_variable_remot...</span></code></pre></div>
</body></html>
      <a href="/2012/03/10/go-deep-into-nginx-operation" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/03/04/magic-about-perl-subroutine-return-value" title="perl函数返回值引起的误会" rel="bookmark">perl函数返回值引起的误会</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-03-04 00:00:00 +0800">04 Mar 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>在微博上偶然看到有位<a href="http://weibo.com/iheartbeat" title="南唐古韵">@南唐古韵</a>童鞋发了一条关于perl的：</p>
<pre><code>发现perl的一个bug：（2**3）**2=8
</code></pre>
<p>显然perl不可能真的犯这么白痴的错误，那么问题在哪呢？我们先看看下面这个判断：</p>
<div class="highlight"><pre><code class="perl"><span class="p">[</span><span class="n">root</span><span class="nv">@localhost</span> <span class="o">~</span><span class="p">]</span><span class="c1"># perl -e 'print "OK" if (2**3)**2 == 8'</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@localhost</span> <span class="o">~</span><span class="p">]</span><span class="c1"># perl -e 'print "OK" if (2**3)**2 == 64'</span>
<span class="n">OK</span>
<span class="p">[</span><span class="n">root</span><span class="nv">@localhost</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</code></pre></div>
<p>一目了然，运算肯定是正确的。那上面那位童鞋的话是怎么得出来的呢？稍微想想，猜他可能是这样：</p>
<div class="highlight"><pre><code class="perl"><span class="p">[</span><span class="n">root</span><span class="nv">@localhost</span> <span class="o">~</span><span class="p">]</span><span class="c1"># perl -e 'print (2**3)**2'</span>
<span class="mi">8</span>
</code></pre></div>
<p>哇，真...</p>
</body></html>
      <a href="/2012/03/04/magic-about-perl-subroutine-return-value" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/02/29/intro-zen-load-balancer" title="ZenLoadBalancer试用(一)" rel="bookmark">ZenLoadBalancer试用(一)</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-02-29 00:00:00 +0800">29 Feb 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body><p>在微博上看到一款叫做Zen LoadBalancer的负载均衡软件更新新闻。于是决定下载来看看，其官网地址是：<a href="http://www.zenloadbalancer.com/web/">http://www.zenloadbalancer.com/web/</a>。具体的说，是基...</p></body></html>
      <a href="/2012/02/29/intro-zen-load-balancer" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/02/14/move-wordpress-to-github" title="从wordpress博客迁移到github记录" rel="bookmark">从wordpress博客迁移到github记录</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-02-14 00:00:00 +0800">14 Feb 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>因为原先托管wordpress博客的阿里云主机被通管局要求备案，加上通管局早令夕改的浪费我来回的快递费，于是决定搬迁到国外，github page的免费托管就此进入我的视界。</p>
<h2 id="github">第一步，申请github账号</h2>
<p>这步大同小异，想个好名字就是了。</p>
<h2 id="section">第二步，创建新项目</h2>
<p>也就是注册完毕后在页面上看到的<a href="https://github.com/repositories/new">“New repository”</a></p>
<p>在页面上填上项目名字。注意如果是要做博客的话，命名是有规范的，必须是yourusername.github.com这样子。</p>
<h2 id="git">第三步，设置本地git环境</h2>
<p>这步参见[“help页面”]:(http://help.github.com/win-set-up-git/)</p>
<h2 id="rubyjekyll">第四步，配置ruby和jekyll环境</h2>
<p>一般来说，linux设备上肯定都已经有了...</p>
</body></html>
      <a href="/2012/02/14/move-wordpress-to-github" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2012/02/13/using-perl-on-dotcloud" title="dotcloud试用" rel="bookmark">dotcloud试用</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2012-02-13 00:00:00 +0800">13 Feb 2012</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#cloud-ref" title="cloud" rel="category tag">cloud</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>dotcloud是日本的一个PAAS厂商。一年多前因为plack作者的加入推出了对perl的支持。我这几个月没事做，今天想起来试试看。用起来确实蛮舒服的。（注：大部分内容是网上已经有了的，我这只是记录一下自己的步骤）
## 第一步，申请账号</p>
<p>就跟普通的网站注册一样，填用户名密码邮箱，邮箱邮件激活——完毕。</p>
<h2 id="section">第二步，安装客户端</h2>
<p>跟安装其他python模块一样：</p>
<div class="highlight"><pre><code class="python"><span class="n">easy_install</span> <span class="n">pip</span> <span class="o">&amp;&amp;</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">dotcloud</span>
</code></pre></div>
<h2 id="section-1">第三步，个人密钥认证</h2>
<p>在dotcloud的个人主页( “settings”:http://www.dotcloud.com/account/settings )上就能看到个人密钥。然后在终端里输入密钥：</p>
<div class="highlight"><pre><code class="bash"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c"># dotcloud...</span></code></pre></div>
</body></html>
      <a href="/2012/02/13/using-perl-on-dotcloud" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/27/conf_run_mod_gearman" title="OMD系列(四)mod_gearman配置与运行" rel="bookmark">OMD系列(四)mod_gearman配置与运行</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-27 00:00:00 +0800">27 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#monitor-ref" title="monitor" rel="category tag">monitor</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body><p>上一篇提到了shinken，这是一个完全重写过的nagios-like系统，如果想尽可能的在原有nagios知识基础上进行高性能的分布式扩展，那么可以使用mod_gearman模块。这个模块可以从github.com上直接获取使用，地址是：
<a href="https://github.com/sni/mod_gearman">https://github.com/sni/mod_gearman</a>
当然，我们这里依然是直接采用了OMD分发的方式，事实上github上也是建议直接采用omd部署，包括升级也可以直接omd update~~（因为从源代码编译的话，在nagios3.2.2版本之前还需要打个patch才能支持eventhandler，既然都得重编译，直接搞新的得了）
在github的“How it works”和“Common Scenarios”两章节里，详细的用图例说明了mod_gearman的工作原理和各种配置情形。我这里就不重复贴了。大概的说，就是可以把nagios配置检测项中的hosts/services/eventhandlers/hostgroups/servicegroups都单独成队列，然后启动多个worker有针对性的完成队列里的任务，...</p></body></html>
      <a href="/2011/12/27/conf_run_mod_gearman" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/20/shinken_discovery_runner" title="OMD系列(三)shinken的discovery配置与运行" rel="bookmark">OMD系列(三)shinken的discovery配置与运行</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-20 00:00:00 +0800">20 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#monitor-ref" title="monitor" rel="category tag">monitor</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>上篇说到OMD的可以通过omd config选择core，有nagios和shinken两个选项。shinken是一个完全重写的监控系统，但是在外部接口上，又是nagios-like的，甚至可以单纯的只用shinken的WebUI给nagios使。所以OMD作为nagios周边的项目，也就把shinken加入到core选项里了。
不过经过试验发现，虽然omd的rpm是针对centos5.5的，代码中调用的有些命令版本却比较高，比如nmap命令使用了–traceroute选项，查ChangeLog发现是4.76版才加上的，而centos5上面的还是4.11版，所以要重新安装：</p>
<div class="highlight"><pre><code class="bash">wget http://nmap.org/dist/nmap-5.51-1.x86_64.rpm
yum remo...</code></pre></div>
</body></html>
      <a href="/2011/12/20/shinken_discovery_runner" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/20/omd_configurations_basic" title="OMD系列(二)基础配置和目录介绍" rel="bookmark">OMD系列(二)基础配置和目录介绍</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-20 00:00:00 +0800">20 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#monitor-ref" title="monitor" rel="category tag">monitor</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>话接上篇，在su和omd start之后，可以看到挂载的一个目录。其/omd是/opt/omd的软连接。目录结构如下：</p>
<div class="highlight"><pre><code class="bash"><span class="o">[</span>monitor@localhost tmp<span class="o">]</span><span class="nv">$ </span>ll /opt/omd/sites/dyxmonitor/
total 12
lrwxrwxrwx  1 monitor dyxmonitor   11 Dec 19 18:15 bin -&gt; vers...</code></pre></div>
</body></html>
      <a href="/2011/12/20/omd_configurations_basic" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/19/omd_intro_install_on_centos5" title="OMD系列(一)简介与安装" rel="bookmark">OMD系列(一)简介与安装</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-19 00:00:00 +0800">19 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#monitor-ref" title="monitor" rel="category tag">monitor</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>OMD，全称Open Monitoring Distribution，是一个围绕Nagios core构建的分布式开源监控集。在nagios基础上融合了NRPE、NSCA、check_mk、mod_gearman、pnp4nagios、nagvis、rrdcached等插件，以完成高性能的、可视化的，分权限管理的监控系统。
（我是在看mod_gearman的安装介绍时看到的，感觉这种一体式的安装很爽）
项目主页是<a href="http://omdistro.org" target="_blank">http://omdistro.org</a>，提供了rh、debian、suse和src各种安装模式。
比如在centos5上面，只需要简单的操作即可：</p>
<div class="highlight"><pre><code class="bash">rpm -Uvh http://downlo...</code></pre></div>
</body></html>
      <a href="/2011/12/19/omd_intro_install_on_centos5" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/19/intro_open_flash_chart" title="Chart::OFC试用" rel="bookmark">Chart::OFC试用</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-19 00:00:00 +0800">19 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body><p>这几天ppt看的比较多，一样一样来玩。今天先说OFC，之前有试过amcharts和fusioncharts。amcharts最全最漂亮（尤其是有scroll和map），可惜图上都自动标上了amcharts.com的字样；fusioncharts的free版本，也蛮好用的，虽然scroll怪怪的居然靠的是点击控制。比较相同的一点就是，这两都只提供了php、python等的模块，如果是perl写的网页，那只能通过提供xml/json数据给js控制的办法。稍微一点点遗憾……
这次在cpan上终于看到一个chart控制的模块，叫Chart::OFC。这个OFC的项目地址如下：
<a href="http://teethgrinder.co.uk/open-flash-chart/" target="_blank">http://teethgrinder.co.uk/open-flash-chart/</a>
其实用法上没什么特殊，无非是省略一点点xml代码，通过OO的方式自动生成而已。让我觉得蛮好玩的是官网上作者的声明。因为他曾经在维护公司一个付费的flash chart项目时，给甲方发信要求修改bug，等了一个月没反应。于是自己现学as语言开始自己搞= =！然后念念不忘的提示说：要重视客户的反馈。。。。。。哈哈
这个项目目前用as3改写，所以新版本叫OFC2了，不过作者自己也说不太稳定，建议继续用OFC1.9.7，所以先不说Chart::OFC2...</p></body></html>
      <a href="/2011/12/19/intro_open_flash_chart" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/15/learning_dancer_plugin_simplecrud" title="Dancer::Plugin::SimpleCRUD模块学习" rel="bookmark">Dancer::Plugin::SimpleCRUD模块学习</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-15 00:00:00 +0800">15 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#dancer-ref" title="dancer" rel="category tag">dancer</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>Dancer圣临历中介绍了一个新插件Dancer::Plugin::SimpleCRUD。可以很快的生成对数据库表的create/read/update/delete。大概阅读了一下代码。主要就是使用HTML::FromDatabase模块生成read的页面，用CGI::FormBuilder模块生成create/update/delete的页面，用Dancer::Plugin::Database::Handle模块操作数据库。因为是Simple，所以html代码都是固定的，不甚美观。但是思路可以学习，通过这两个模块，可以自己结合Dancer的template系统做CRUD了。
先来说HTML::FromDatabase模块，这个只涉及select，所以特别简单：</p>
<div class="highlight"><pre><code class="perl"><span class="n">any</span> <span class="p">[</span><span class="s">'get'</span><span class="p">,</span> <span class="s">'post'...</span></code></pre></div>
</body></html>
      <a href="/2011/12/15/learning_dancer_plugin_simplecrud" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/12/12/nginx_perl_demo" title="nginx_perl试用" rel="bookmark">nginx_perl试用</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-12-12 00:00:00 +0800">12 Dec 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#nginx-ref" title="nginx" rel="category tag">nginx</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body><p>因为空闲时间比较多，所以在CPAN上乱翻，看到了nginx_perl这个项目(原名Nginx::Engine)，现在托管在github.com上。地址见：
https://github.com/zzzcpan/nginx-perl
这个模块的目的，是在nginx内置官方perl模块的基础上，实现一系列异步非阻塞的api。用connector/writer/reader完成类似...</p></body></html>
      <a href="/2011/12/12/nginx_perl_demo" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/11/04/test_websocket_with_dancer" title="websocket体验" rel="bookmark">websocket体验</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-11-04 00:00:00 +0800">04 Nov 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#dancer-ref" title="dancer" rel="category tag">dancer</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body><p>因为看到mojo在宣传其内置websocket支持，去CPAN上search了一下，发现Dancer也有plugin做websocket用。稍微看了一下，很显然没看mojo的内嵌代码，而dancer的plugin代码倒是相当简单。
简单的说，就是通过AnyMQ、Plack和Web::Hippie的组合完成。注意的是，因为Web::Hippie使用了AnyEvent::Handle管理websocket的fh，AnyMQ也使用AnyEvent管理message queue，所以在启动plackup的时候，必须使用AnyEvent核心的Twiggy服务器。
Plugin里硬编码很多。比较重要的地方就是”set plack_middlewares_map”，plack_middlewares_map是dancer新加的功能，这里用URLMap来mount ‘/_hippie’到Web::Hip...</p></body></html>
      <a href="/2011/11/04/test_websocket_with_dancer" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/11/04/perl_oauth_to_weibo_api" title="用perl调用新浪微博API小实验" rel="bookmark">用perl调用新浪微博API小实验</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-11-04 00:00:00 +0800">04 Nov 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#dancer-ref" title="dancer" rel="category tag">dancer</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>新浪微博API是通过OAuth方式的。perl上有现成的模块，只需要稍微调一下参数就行了。下午比较闲，试试看。。。
一般网上说的，都还是Net::OAuth模块，这个是1.0a版本的，一看perldoc那个长篇就头疼。这里我用Net::OAuth2模块，简单方便，而且正好配合dancer框架，方便做外部网站应用。
首先是安装模块：</p>
<div class="highlight"><pre><code class="perl"><span class="n">cpanm</span> <span class="o">--</span><span class="n">mirror</span><span class="o">-</span><span class="n">only</span> <span class="o">--</span><span class="n">mirror</span> <span class="n">http:</span><span class="sr">//mi</span><span class="n">rrors</span><span class="mf">.163</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">cpan</span> <span class="nn">LWP::Protocol::</span><span class="n">https</span> <span class="nn">Net::OAuth2::</span><span class="n">Client</span>
</code></pre></div>
<p>因为新浪微博的api...</p>
</body></html>
      <a href="/2011/11/04/perl_oauth_to_weibo_api" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/10/26/a_perl_extended_regex" title="一个perl扩展正则表达式" rel="bookmark">一个perl扩展正则表达式</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-10-26 00:00:00 +0800">26 Oct 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>今天傍晚，莫言在Q群里贴了一个他写的正则表达式，回来翻了翻perlre文档，基本算是看懂，赶紧记录下来：</p>
<div class="highlight"><pre><code class="perl"><span class="k">my</span> <span class="nv">$ip</span> <span class="o">=</span> <span class="s">"192.168.0.1|192.168.0.2|192.168.0.1"</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span> <span class="nv">$ip</span> <span class="o">=~</span><span class="sr"> /</span>
<span class="sr">    ^</span>
<span class="sr">    (?:</span>
<span class="sr">        ((?:\d{1,3}\.){3}\d{1,3})</span>
<span class="sr">        (?=</span>
<span class="sr">            (?:</span>
<span class="sr">                \|(?!\1)(?1)</span>
<span class="sr">            )*</span>
<span class="sr">            \z</span>
<span class="sr">        )</span>
<span class="sr">        \|</span>
<span class="sr">    )*</span>
<span class="sr">    (?1)</span>
<span class="sr">    $</span>
<span class="sr">    /x</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"match\n"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>根据<a href="http://perldoc.perl.org/perlre.html" title="perlre文档" target="_blank">perlre文档</a>的说明，一点一点解释。
 首先是/x，用这个来去除regex里的空格，不然的话写在一行太难看懂了；
 然后是^，表示从最开头开始；
 然后是(?:，这个表示本括号不记入反向引用$&amp;中；
 然后是((?:\d{1,3}.){3}\d{1,3})，同样里面一个(?:，也就是说这一行匹配一个ip，并计为$1；
 然后是(?=，这个表示在上面那行ip的正则后面必须出现符合本括号定义，同样也不计入$&amp;（术语叫”零宽肯定前向断言”是吧？）；
 然后一个隔开ip的|；
 然后是(?!，这个表示本括号内的东西绝对不能出现，同样也不计入$&amp;（术语叫”零宽否定前向断言”是吧？）；
 然后是\1，这个就是前面捕获的$1，跟上行解释的断言合在一起，就是|后面不能有和前面匹配的ip重复；
 然后是(?1，这个表示前面捕获$1的正则表达式，也就是不重复ip的情况下，继续捕获新i...</p>
</body></html>
      <a href="/2011/10/26/a_perl_extended_regex" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/10/25/rewrite_template_for_squid-conf" title="用Template::Tookit给squid.conf写模板" rel="bookmark">用Template::Tookit给squid.conf写模板</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-10-25 00:00:00 +0800">25 Oct 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>本文纯属练习Template模块使用，是否可以运用到生产，是否有必要运用到生产，都是未知数……
包括如下文件：</p>
<div class="highlight"><pre><code class="bash"><span class="o">[</span>raocl@localhost tt2-test<span class="o">]</span><span class="nv">$ </span>tree
.
|-- config-cdcgame.net.yml
|-- config-china.com.yml
|-- config.tt
|-- hostconfig.yml
|-- squid.layout.tt
<span class="sb">`</span>-- tt4squid.pl
0 directories, 6 files
</code></pre></div>
<p>其中tt4squid.pl如下：</p>
<div class="highlight"><pre><code class="perl"><span class="c1">#!/usr/bin/perl</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">Template</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">YAML::</span><span class="n">Syck</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$config_path</span> <span class="o">=</span> <span class="s">'./'...</span></code></pre></div>
</body></html>
      <a href="/2011/10/25/rewrite_template_for_squid-conf" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/10/24/backup-script-4-my-blog" title="blog备份脚本" rel="bookmark">blog备份脚本</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-10-24 00:00:00 +0800">24 Oct 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>之前总不重视自己的博客，上回一丢才心疼，现在重视起来，决定定期备份sql。写个小脚本如下：</p>
<div class="highlight"><pre><code class="perl"><span class="c1">#!/usr/bin/perl</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">MySQL::</span><span class="n">Backup</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Mail::</span><span class="n">Sender</span><span class="p">;</span>
<span class="nb">open</span> <span class="k">my</span> <span class="nv">$tmp_sql</span><span class="p">,</span> <span class="s">'&gt;'</span><span class="p">,</span> <span class="s">"backup.sql"</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$mb</span> <span class="o">=</span> <span class="k">new</span> <span class="nn">MySQL::</span><span class="n">Backup</span><span class="p">(</span><span class="s">'dbname'</span><span class="p">,</span> <span class="s">'localhost'</span><span class="p">,</span> <span class="s">'dbuser'</span><span class="p">,</span> <span class="s">'dbpasswd'</span><span class="p">,</span> <span class="p">{</span><span class="s">'USE_REPLACE'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'SHOW_TABLE_NAMES'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">});</span>
<span class="k">print</span> <span class="nv">$tmp_sql</span> <span class="nv">$mb</span><span class="o">-&gt;</span><span class="n">create_structure</span><span class="p">();</span>
<span class="k">print</span> <span class="nv">$tmp_sql</span> <span class="nv">$mb</span><span class="o">-&gt;</span><span class="n">data_b...</span></code></pre></div>
</body></html>
      <a href="/2011/10/24/backup-script-4-my-blog" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/10/20/screenshot-4-cloudhosting-down" title="博客恢复了，截图纪念一下" rel="bookmark">博客恢复了，截图纪念一下</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-10-20 00:00:00 +0800">20 Oct 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>这两天折腾博客宕机问题啊~原本对阿里云的看好大幅下降……几次挂掉，甚至电话告知说数据恢复不了请自行重置……崩溃原因居然解释说“因为你没有修改grub再重启”这种解释，拜托，我要重启还不是因为突然ssh报密码错误而你们“重置密码必须重启”？死循环啊！
对了，我人格保证，作为一个用xen当工作环境一年多的运维，绝对没有犯自行升级内核导致重启失败这种错误的可能。阿里云客服能不能不要把一个客户的缘由安到别的客户头上……
不管如何，结局还是好的。截个监控宝的告警图纪念一下：
<img src="/images/uploads/20111020192305.png" alt="" title="aliyunOS" width="856" height="332" class="alignnone size-full wp-image-2647"></p>
</body></html>
      <a href="/2011/10/20/screenshot-4-cloudhosting-down" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/10/17/notes-about-probind" title="ProBIND体验笔记" rel="bookmark">ProBIND体验笔记</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-10-17 00:00:00 +0800">17 Oct 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#DNS-ref" title="DNS" rel="category tag">DNS</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body><p>闲的无聊，继续研究DNS周边产品，这次盯上了Probind。这是搜索结果中比较常见的bind的web管理工具。其实我是比较希望有个中文的东东方便我偷懒，可惜看sina之前的xbayDNS一直停留在了只支持FreeBSD/MAC的阶段没有更新，汗，不支持linux的项目偶见过的还真不多……
probind最近一次更新也是2003/05/24的事情了。所以也没期待它能多么适应现在的bind体系，不过作为代码看看还是可以的。
创建mysql用户和...</p></body></html>
      <a href="/2011/10/17/notes-about-probind" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/09/30/dynamic-dns-demo" title="一个ddns的demo" rel="bookmark">一个ddns的demo</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-09-30 00:00:00 +0800">30 Sep 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#perl-ref" title="perl" rel="category tag">perl</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>上回分析lbnamed的时候，开玩笑说自己也可以试试在模块基础上加点啥功能。国庆节前最后一天，没啥事情做，就写个小demo续貂。代码如下：</p>
<div class="highlight"><pre><code class="perl"><span class="c1">#!/usr/bin/perl</span>
<span class="k">use</span> <span class="n">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="n">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="n">autodie</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Sys::</span><span class="n">Hostname</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">YAML::</span><span class="n">Syck</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Net::IP::Match::</span><span class="n">Regexp</span> <span class="sx">qw( create_iprange_regexp match_ip )</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Stanford::</span><span class="n">DNS</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Stanford::</span><span class="n">DNSserver</span><span class="p">;</span>
<span class="nv">$SIG</span><span class="p">{</span><span class="s">'HUP'</span><span class="p">}</span> <span class="o">=</span> <span class="s">'catch_hup'</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$need_reload</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$hostmaster</span> <span class="o">=</span> <span class="s">'doma...</span></code></pre></div>
</body></html>
      <a href="/2011/09/30/dynamic-dns-demo" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div class="full" style='background-color: #FFF;'>
    <h1 class="entry-title">
      <a href="/2011/09/29/dancing-website-for-sync-dist-3" title="写个同步分发系统(三)" rel="bookmark">写个同步分发系统(三)</a>
    </h1>
    <p class="alt-font tight">
      <span class="date full-date">
        <abbr class="published" title="2011-09-29 00:00:00 +0800">29 Sep 2011</abbr>
      </span>
      <span>
      </span>
      Posted in&nbsp;
      <a href="/categories.html#dancer-ref" title="dancer" rel="category tag">dancer</a>
    </p>
    <div class="entry-content full-content" style='background-color: #FFF; margin-left: 24px; padding: 10px;'>
      <html><body>
<p>上篇写的页面上，留下一个超链接，查看每条任务的具体情况。现在完成这部分。
首先修改数据库结构，上篇已经建了websync.websync_peer表，现在继续：</p>
<div class="highlight"><pre><code class="mysql"><span class="k">create</span> <span class="k">table</span> <span class="nf">websync_customer</span> <span class="p">(</span>
    <span class="n">uid</span> <span class="kt">int</span> <span class="k">not</span> <span class="no">null</span> <span class="kp">auto_increment</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="n">user</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
    <span class="n">passwd</span> <span class="kt">char</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
    <span class="n">custom_info</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">node</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span>
<span class="p">)</span> <span class="kp">engine</span><span class="o">=</span><span class="n">innodb</span><span class="p">;</span>
<span class="k">create</span> <span class="k">table</span> <span class="nf">remote_node</span> <span class="p">(</span>
    <span class="n">nid</span> <span class="kt">int</span> <span class="k">not</span> <span class="no">null</span> ...</code></pre></div>
</body></html>
      <a href="/2011/09/29/dancing-website-for-sync-dist-3" class="read_more span2 pull-right">继续阅读……</a>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>
  <div id="post-pagination" class="pagination pagination-centered">
  <ul class="pages nav nav-pills">
    <li>
      <a href="/page3">Previous</a>
    </li>
    <li class="page">
      <a href="/">1</a>
    </li>
    <li class="page">
      <a href="/page2">2</a>
    </li>
    <li class="page">
      <a href="/page3">3</a>
    </li>
    <li class="page active">
      <a href="#">4</a>
    </li>
    <li class="page">
      <a href="/page5">5</a>
    </li>
    <li class="page">
      <a href="/page6">6</a>
    </li>
    <li class="page">
      <a href="/page7">7</a>
    </li>
    <li class="page">
      <a href="/page8">8</a>
    </li>
    <li class="page">
      <a href="/page9">9</a>
    </li>
    <li class="page">
      <a href="/page10">10</a>
    </li>
    <li class="page">
      <a href="/page11">11</a>
    </li>
    <li class="page">
      <a href="/page12">12</a>
    </li>
    <li class="page">
      <a href="/page13">13</a>
    </li>
    <li class="page">
      <a href="/page14">14</a>
    </li>
    <li class="page">
      <a href="/page15">15</a>
    </li>
    <li>
      <a href="/page5">Next</a>
    </li>
  </ul>
</div>
</div>
      </div>
      <div class="span4">
          <div class="well sidebar-nav">
             <ul id="relate_blog" class="nav nav-list">
               <li class="nav-header">最近文章</li>
            </ul>
          </div>
        <div class="well sidebar-nav">
          <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=2&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=1035836154&verifier=a26926d5&dpc=1"></iframe>
        </div>
        <div class="well sidebar-nav">
            <!--以下是QQ邮件列表订阅嵌入代码-->
            <script >var nId = "86cca8e03c1002936e00aaa28bd933c15c4a437a5e63cafd",nWidth="auto",sColor="light",sText="填写您的邮件地址，订阅logstash/ElasticSearch相关讨论：" ;</script><script src="http://list.qq.com/zh_CN/htmledition/js/qf/page/qfcode.js" charset="gb18030"></script>
        </div>
        <div class="well sidebar-nav">
            <div id="uyan_list_time_frame"></div>
            <script type="text/javascript" id="UYScriptTime" src="http://v1.uyan.cc/js/iframe_time_list.js?UYUserId=1589850&rankType=time" async=""></script>
        </div>
        <div class="well sidebar-nav">
          <ul id="linklists" class="nav nav-list">
            <li class="nav-header">友情链接</li>
              <li><a href="http://codeascraft.com/" title="Etsy 运维团队博客">Code as Craft</a></li>
              <li><a href="http://blog.dotcloud.com/" title="dotCloud 官方博客">dotCloud-Blog</a></li>
              <li><a href="http://devopsanywhere.blogspot.jp/" title="">devopsanywhere</a></li>
              <li><a href="http://www.icylife.net/blog/" title="">心路</a></li>
              <li><a href="http://www.jedi.be/blog/" title="">Jong En Dynamische Informatica</a></li>
              <li><a href="http://www.planetdevops.net/" title="">planetdevops</a></li>
              <li><a href="http://www.kitchensoap.com/" title="《网站运维》作者，Etsy 运维">Kitchen Soap</a></li>
              <li><a href="http://blog.johngoulah.com" title="Musings of linux, open source, cloud computing and systems">John Goulah</a></li>
              <li><a href="http://dbahacker.com/" title="TB 杨德华">DBA Hacker</a></li>
              <li><a href="http://www.nginxs.com/" title="">eric</a></li>
              <li><a href="http://www.hellodb.net/" title="Ali DBA 张瑞">Hello DBA</a></li>
              <li><a href="http://blog.laird-sa.com/" title="">Laird-SA</a></li>
              <li><a href="http://www.linuxsee.com/" title="">LinuxSEE</a></li>
              <li><a href="http://blog.nosqlfan.com/" title="not only sql信息集散地">NoSQLfan</a></li>
              <li><a href="http://ourmysql.com/" title="">OurMySQL</a></li>
              <li><a href="http://www.puppeter.cn/" title="">piol</a></li>
              <li><a href="http://www.ducea.com/" title="">MDLog:/sysadmin</a></li>
              <li><a href="http://www.sanote.org/" title="">sa note</a></li>
              <li><a href="http://serverfault.com/" title="stackexchange下属的系统工程师问答网站">serverfault</a></li>
              <li><a href="http://zauc.wordpress.com/" title="">Timo</a></li>
              <li><a href="http://julyclyde.org/" title="新浪系统工程师">七月的夏天</a></li>
              <li><a href="http://www.liurongxing.com/" title="">刘荣星</a></li>
              <li><a href="http://blog.s135.com/" title="金山·张宴">回忆未来</a></li>
              <li><a href="http://blog.ops.tudou.com/wp/" title="">土豆运营团队</a></li>
              <li><a href="http://www.91tuanfang.com/" title="安居客运维">家欣的天空</a></li>
              <li><a href="http://www.cnadn.net/" title="F5工程师">应用交付学习之路</a></li>
              <li><a href="http://scmbob.org/" title="杭州NSN工程师，shell高人~">扛一肩记忆</a></li>
              <li><a href="http://www.php-oa.com/" title="音悦台技术经理">扶凯</a></li>
              <li><a href="http://www.wenzizone.cn/" title="">蚊子世界</a></li>
              <li><a href="http://www.opboy.com" title="">运维小子</a></li>
              <li><a href="http://blog.liuts.com/" title="前天涯SA 刘天斯">运维进行时</a></li>
              <li><a href="http://www.lark.net.cn/" title="lark's cloud">lark's cloud</a></li>
              <li><a href="http://log.heartoutside.com/" title="HeartOutSide">HeartOutside</a></li>
              <li><a href="http://blog.liulantao.com/" title="lax">Lax</a></li>
              <li><a href="http://l09.me/" title="风声">风声</a></li>
              <li><a href="http://shellblog.info/" title="莫言">莫言</a></li>
              <li><a href="http://mooser.me/" title="牛氓">牛氓</a></li>
              <li><a href="http://http://www.yinwang.org/" title="当然我在扯淡">当然我在扯淡</a></li>
              <li><a href="http://noops.me/" title="">NoOps</a></li>
              <li><a href="http://www.searchtech.pro/" title="">云端分布式搜索技术</a></li>
              <li><a href="http://www.thegeekstuff.com/" title="各种超酷Linux命令用法">TheGeekStuff</a></li>
          </ul>
        </div>
      </div>
    </div> <!-- row -->
      <footer>
        <p>&copy; 陈子 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>
    </div> <!-- /container -->
    <!-- JiaThis Button BEGIN -->
    <script type="text/javascript">var jiathis_config = {data_track_clickback:true};</script>
    <script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?move=0&amp;uid=1589850" charset="utf-8"></script>
    <!-- JiaThis Button END -->
    <!-- UJian Button BEGIN -->
    <script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?type=slide&uid=1589850"></script>
    <!-- UJian Button END -->
  </body>
</html>
